<!DOCTYPE html>

<html class="article-header-style-1">
<head><!-- hexo injector head_begin start -->
<link rel="stylesheet" href="/css/bilicard.css">
<!-- hexo injector head_begin end -->

</script>
	<link rel="stylesheet" type="text/css" href="https://bohanjun.github.io/live2d/waifu.css" />
	<div class="waifu" id="waifu" style="z-index: 99999999;">
  	  <div class="waifu-tips"></div>
   	 <canvas id="live2d" width="280" height="250" class="live2d"></canvas>
	</div>
	<script src="https://bohanjun.github.io/live2d/live2d.js"></script>
	<script src="https://bohanjun.github.io/live2d/waifu-tips.js"></script>
	<script type="text/javascript">initModel()</script>
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/styles/a11y-light.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js"></script>
	
	<title>[笔记] 莫队 学习笔记 - 沉石鱼惊旋 的博客</title>
	<meta charset="utf-8">
	
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
	
	<meta name="description" content="蒸馍身边一群大神不会普通莫队。 现在每天半夜不写点根号算法都睡不着。根号算法个个是优雅的算法&#x2F;se 莫队处理离线区间询问。 名字由来是因为是莫涛整理的。 普通莫队简介可以较优复杂度从 $[l\pm1,r\pm1]$ 转到 $[l,r]$。 当 $n,q$ 同阶时，若转移为 $\mathcal O(1)$，总复杂度即为 $\mathcal O(n\sqrt n)$。同理，转移为 $\mat">
<meta property="og:type" content="article">
<meta property="og:title" content="[笔记] 莫队 学习笔记">
<meta property="og:url" content="http://blog.cyx2009.top/archives/Mo_s_algorithm/index.html">
<meta property="og:site_name" content="沉石鱼惊旋 的博客">
<meta property="og:description" content="蒸馍身边一群大神不会普通莫队。 现在每天半夜不写点根号算法都睡不着。根号算法个个是优雅的算法&#x2F;se 莫队处理离线区间询问。 名字由来是因为是莫涛整理的。 普通莫队简介可以较优复杂度从 $[l\pm1,r\pm1]$ 转到 $[l,r]$。 当 $n,q$ 同阶时，若转移为 $\mathcal O(1)$，总复杂度即为 $\mathcal O(n\sqrt n)$。同理，转移为 $\mat">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.luogu.com.cn/upload/image_hosting/ddbq2clq.png">
<meta property="og:image" content="https://cdn.luogu.com.cn/upload/image_hosting/jo4d8k7b.png">
<meta property="og:image" content="https://cdn.luogu.com.cn/upload/image_hosting/2i6hvf8d.png">
<meta property="article:published_time" content="2024-02-02T03:10:00.000Z">
<meta property="article:modified_time" content="2025-02-12T12:27:58.316Z">
<meta property="article:author" content="CYX">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.luogu.com.cn/upload/image_hosting/ddbq2clq.png">

	<meta name="theme-color" content="#5e72e4">
	<meta name="theme-color-rgb" content="94,114,228">
	<meta name="theme-color-origin" content="#5e72e4">
	<meta name="argon-enable-custom-theme-color" content="true">
	<meta name="theme-card-radius" content="15">
	<meta name="theme-version" content="1.0.2">
	<link rel="icon" href="/assets/img/favicon.ico">
	<!-- <link rel="shortcut icon" href="/assets/img/favicon.ico"> -->
	<!-- <link rel="shortcut icon" href="https://s2.loli.net/2022/07/28/dj7Y3yrweQ2MXNb.png"> -->
	
<link rel="stylesheet" href="/assets/argon_css_merged.css">

	
<link rel="stylesheet" href="/style.css">

	
<link rel="stylesheet" href="//fonts.loli.net/css?family=Open+Sans:300,400,600,700|Noto+Serif+SC:300,600&display=swap.css">

	
<script src="/assets/argon_js_merged.js"></script>

	
<script src="/assets/js/argon.min.js"></script>

	
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


	

	<script>
		var argonConfig = {
			language: "zh_CN",
			
				zoomify: {
					duration: 200,
					easing: "cubic-bezier(0.4,0,0,1)",
					scale: 0.9
				},
			
			pangu: "false",
			
				lazyload: {
					threshold: 800,
					effect: "fadeIn"
				},
			
			disable_pjax: false,
			headroom: false
		}
	</script>
	<script>
		var darkmodeAutoSwitch = "false";
		function setDarkmode(enable){
			if (enable == true){
				$("html").addClass("darkmode");
			}else{
				$("html").removeClass("darkmode");
			}
			$(window).trigger("scroll");
		}
		function toggleDarkmode(){
			if ($("html").hasClass("darkmode")){
				setDarkmode(false);
				sessionStorage.setItem("Argon_Enable_Dark_Mode", "false");
			}else{
				setDarkmode(true);
				sessionStorage.setItem("Argon_Enable_Dark_Mode", "true");
			}
		}
		if (sessionStorage.getItem("Argon_Enable_Dark_Mode") == "true"){
			setDarkmode(true);
		}
		function toggleDarkmodeByPrefersColorScheme(media){
			if (sessionStorage.getItem('Argon_Enable_Dark_Mode') == "false" || sessionStorage.getItem('Argon_Enable_Dark_Mode') == "true"){
				return;
			}
			if (media.matches){
				setDarkmode(true);
			}else{
				setDarkmode(false);
			}
		}
		function toggleDarkmodeByTime(){
			if (sessionStorage.getItem('Argon_Enable_Dark_Mode') == "false" || sessionStorage.getItem('Argon_Enable_Dark_Mode') == "true"){
				return;
			}
			let hour = new Date().getHours();
			if (hour < 7 || hour >= 22){
				setDarkmode(true);
			}else{
				setDarkmode(false);
			}
		}
		if (darkmodeAutoSwitch == 'system'){
			var darkmodeMediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
			darkmodeMediaQuery.addListener(toggleDarkmodeByPrefersColorScheme);
			toggleDarkmodeByPrefersColorScheme(darkmodeMediaQuery);
		}
		if (darkmodeAutoSwitch == 'time'){
			toggleDarkmodeByTime();
		}
		if (darkmodeAutoSwitch == 'alwayson'){
			setDarkmode(true);
		}

		function toggleAmoledDarkMode(){
			$("html").toggleClass("amoled-dark");
			if ($("html").hasClass("amoled-dark")){
				localStorage.setItem("Argon_Enable_Amoled_Dark_Mode", "true");
			}else{
				localStorage.setItem("Argon_Enable_Amoled_Dark_Mode", "false");
			}
		}
		if (localStorage.getItem("Argon_Enable_Amoled_Dark_Mode") == "true"){
			$("html").addClass("amoled-dark");
		}else if (localStorage.getItem("Argon_Enable_Amoled_Dark_Mode") == "false"){
			$("html").removeClass("amoled-dark");
		}
	</script>
	<script>
		if (navigator.userAgent.indexOf("Safari") !== -1 && navigator.userAgent.indexOf("Chrome") === -1){
			$("html").addClass("using-safari");
		}
	</script>

	
		
<script src="/assets/vendor/smoothscroll/smoothscroll1.js"></script>

	
<meta name="generator" content="Hexo 7.3.0"></head>



<style id="themecolor_css">
	
	:root{
		--themecolor: #5e72e4;
		--themecolor-dark0: #5368E2;
		--themecolor-dark: #485FE0;
		--themecolor-dark2: #324CDD;
		--themecolor-dark3: #233DD2;
		--themecolor-light: #8A98EB;
		--themecolor-rgbstr: 94,114,228;
		--themecolor-gradient: linear-gradient(150deg,var(--themecolor-light) 15%, var(--themecolor) 70%, var(--themecolor-dark0) 94%);

	}
</style>
<style id="theme_cardradius_css">
	:root{
		--card-radius: 15px;
	}
</style>

<body>
<div id="toolbar">
	<!-- <script>
		window.open('http://img.chen2009.tk/','_blank');
	</script> -->
	<header class="header-global">
		<nav id="navbar-main" class="navbar navbar-main navbar-expand-lg navbar-transparent navbar-light bg-primary headroom--not-bottom headroom--not-top headroom--pinned">
			<div class="container">
				
					<a class="navbar-brand navbar-icon mr-lg-5" href="">
						<img src="/assets/img/favicon.ico">
					</a>
				
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_global" aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<a class="navbar-brand" href="/">沉石鱼惊旋 的博客</a>
				<div class="navbar-collapse collapse" id="navbar_global">
					<div class="navbar-collapse-header">
						<div class="row">
							<div class="col-6 collapse-brand"></div>
							<div class="col-6 collapse-close">
								<button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar_global" aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
									<span></span>
									<span></span>
								</button>
							</div>
						</div>
					</div>
					<ul id="navbar_search_btn_mobile" class="navbar-nav align-items-lg-center ml-lg-auto">
						<li class="nav-item" data-toggle="modal" data-target="#argon_search_modal" style="padding-left: 5px;">
							<a class="nav-link nav-link-icon">
								<i class="fa fa-search"></i>
								<span class="nav-link-inner--text d-lg-none">搜索</span>
							</a>
						</li>
					</ul>
					
							<ul class='navbar-nav navbar-nav-hover align-items-lg-center'>
								
										<li class='nav-item'>
											<a href='/' class='nav-link' >
												<i class='ni ni-book-bookmark d-lg-none'></i>
												<span class='nav-link-inner--text'>首页</span>
											</a>
											
										</li>
									
										<li class='nav-item'>
											<a href='/archives' class='nav-link' >
												<i class='ni ni-book-bookmark d-lg-none'></i>
												<span class='nav-link-inner--text'>归档</span>
											</a>
											
										</li>
									
										<li class='nav-item'>
											<a href='/friends' class='nav-link' >
												<i class='ni ni-book-bookmark d-lg-none'></i>
												<span class='nav-link-inner--text'>友链</span>
											</a>
											
										</li>
									
							</ul>
						
					<ul class="navbar-nav align-items-lg-center ml-lg-auto">
						<li class="nav-item" data-toggle="modal" data-target="#argon_search_modal" id="navbar_search_btn_pc">
							<a class="nav-link nav-link-icon">
								<i class="fa fa-search"></i>
								<span class="nav-link-inner--text d-lg-none">搜索</span>
							</a>
						</li>
					</ul>
				</div>
				
					<a class="navbar-brand navbar-icon-mobile" href="">
						<img src="/assets/img/favicon.ico">
					</a>
				
				<div id="navbar_menu_mask" data-toggle="collapse" data-target="#navbar_global"></div>
			</div>
		</nav>
	</header>
</div>
<div class="modal fade" id="argon_search_modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">搜索</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<!-- TODO -->
<div class="form-group mb-3">
	<div class="input-group input-group-alternative">
		<div class="input-group-prepend">
			<span class="input-group-text"><i class="fa fa-search"></i></span>
		</div>
		<input id="local-search-input" class="form-control" placeholder="搜索什么..." type="text"  autocomplete="off" data-search.path="search.xml" data-config.root="/">
	</div>
	<div id="local-search-result"></div>
</div>

			</div>
		</div>
	</div>
</div>
<!--Banner-->
<section id="banner" class="banner section section-lg section-shaped">
	<div class="shape shape-style-1 shape-primary">
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
	</div>

	
	<div id="banner_container" class="banner-container container text-center">
		
			<div class="banner-title text-white" data-text="沉石鱼惊旋 的博客" data-interval=""><span class="banner-title-inner">&nbsp;</span>
		
		</div>
	</div>
	
		<style>
			section.banner{
				background-image: url(/assets/img/banner.jpg) !important;
			}
		</style>
	
</section>


	<style>
		#content:before {
			content: '';
			display: block;
			position: fixed;
			left: 0;
			right: 0;
			top: 0;
			bottom: 0;
			z-index: -2;
			background: url(/assets/img/banner.jpg);
			background-position: center;
			background-size: cover;
			background-repeat: no-repeat;
			opacity: 1;
			transition: opacity .5s ease;
		}
		html.darkmode #content:before{
			filter: brightness(0.65);
		}
		
			#content:after {
				content: '';
				display: block;
				position: fixed;
				left: 0;
				right: 0;
				top: 0;
				bottom: 0;
				z-index: -2;
				background: url(/assets/img/banner.jpg);
				background-position: center;
				background-size: cover;
				background-repeat: no-repeat;
				opacity: 0;
				transition: opacity .5s ease;
			}
			html.darkmode #content:after {
				opacity: 1;
			}
			html.darkmode #content:before {
				opacity: 0;
			}
		
		
			#banner, #banner .shape {
				background: transparent !important;
			}
		
	</style>




<div id="float_action_buttons" class="float-action-buttons fabtns-unloaded">
	<!-- <button id="fabtn_toggle_sides" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-hidden="true" tooltip-move-to-left="移至左侧" tooltip-move-to-right="移至右侧">
		<span class="btn-inner--icon fabtn-show-on-right"><i class="fa fa-caret-left"></i></span>
		<span class="btn-inner--icon fabtn-show-on-left"><i class="fa fa-caret-right"></i></span>
	</button> -->
	<button id="fabtn_back_to_top" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-label="Back To Top" tooltip="回到顶部">
		<span class="btn-inner--icon"><i class="fa fa-angle-up"></i></span>
	</button>
	<button id="fabtn_go_to_comment" class="btn btn-icon btn-neutral fabtn shadow-sm d-none" type="button" <-% theme.fab_show_gotocomment_button ? "" : "style='display: none;'"  aria-label="Comment" tooltip="评论">
		<span class="btn-inner--icon"><i class="fa fa-comment-o"></i></span>
	</button>
	<button id="fabtn_toggle_darkmode" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" <-% theme.fab_show_darkmode_button ? "" : "style='display: none;'"  aria-label="Toggle Darkmode" tooltip-darkmode="夜间模式" tooltip-blackmode="暗黑模式" tooltip-lightmode="日间模式">
		<span class="btn-inner--icon"><i class="fa fa-moon-o"></i><i class='fa fa-lightbulb-o'></i></span>
	</button>
	<button id="fabtn_toggle_blog_settings_popup" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" <-% theme.fab_show_settings_button ? "" : "style='display: none;'"  aria-label="Open Blog Settings Menu" tooltip="设置">
		<span class="btn-inner--icon"><i class="fa fa-cog"></i></span>
	</button>
	<div id="fabtn_blog_settings_popup" class="card shadow-sm" style="opacity: 0;" aria-hidden="true">
		<div id="close_blog_settings"><i class="fa fa-close"></i></div>
		<div class="blog-setting-item mt-3">
			<div style="transform: translateY(-4px);"><div id="blog_setting_toggle_darkmode_and_amoledarkmode" tooltip-switch-to-darkmode="切换到夜间模式" tooltip-switch-to-blackmode="切换到暗黑模式"><span>夜间模式</span><span>暗黑模式</span></div></div>
			<div style="flex: 1;"></div>
			<label id="blog_setting_darkmode_switch" class="custom-toggle">
				<span class="custom-toggle-slider rounded-circle"></span>
			</label>
		</div>
		<div class="blog-setting-item mt-3">
			<div style="flex: 1;">字体</div>
			<div>
				<button id="blog_setting_font_sans_serif" type="button" class="blog-setting-font btn btn-outline-primary blog-setting-selector-left">Sans Serif</button><button id="blog_setting_font_serif" type="button" class="blog-setting-font btn btn-outline-primary blog-setting-selector-right">Serif</button>
			</div>
		</div>
		<div class="blog-setting-item mt-3">
			<div style="flex: 1;">阴影</div>
			<div>
				<button id="blog_setting_shadow_small" type="button" class="blog-setting-shadow btn btn-outline-primary blog-setting-selector-left">浅阴影</button><button id="blog_setting_shadow_big" type="button" class="blog-setting-shadow btn btn-outline-primary blog-setting-selector-right">深阴影</button>
			</div>
		</div>
		<div class="blog-setting-item mt-3 mb-3">
			<div style="flex: 1;">滤镜</div>
			<div id="blog_setting_filters" class="ml-3">
				<button id="blog_setting_filter_off" type="button" class="blog-setting-filter-btn ml-0" filter-name="off">关闭</button>
				<button id="blog_setting_filter_sunset" type="button" class="blog-setting-filter-btn" filter-name="sunset">日落</button>
				<button id="blog_setting_filter_darkness" type="button" class="blog-setting-filter-btn" filter-name="darkness">暗化</button>
				<button id="blog_setting_filter_grayscale" type="button" class="blog-setting-filter-btn" filter-name="grayscale">灰度</button>
			</div>
		</div>
		<div class="blog-setting-item mb-3">
			<div id="blog_setting_card_radius_to_default" style="cursor: pointer;" tooltip="恢复默认">圆角</div>
			<div style="flex: 1;margin-left: 20px;margin-right: 8px;transform: translateY(2px);">
				<div id="blog_setting_card_radius"></div>
			</div>
		</div>
		
			<div class="blog-setting-item mt-1 mb-3">
				<div style="flex: 1;">主题色</div>
				<div id="theme-color-picker" class="ml-3"></div>
			</div>
		
	</div>
	<button id="fabtn_open_sidebar" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-label="Open Sidebar Menu" tooltip="菜单">
		<span class="btn-inner--icon"><i class="fa fa-bars"></i></span>
	</button>
	<button id="fabtn_reading_progress" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-hidden="true" tooltip="阅读进度">
		<div id="fabtn_reading_progress_bar" style="width: 0%;"></div>
		<span id="fabtn_reading_progress_details">0%</span>
	</button>
</div>

<div id="content" class="site-content">









<div class="page-information-card-container">
	
</div>

<div id="sidebar_mask"></div>
<aside id="leftbar" class="leftbar widget-area" role="complementary">
		
			<div id="leftbar_announcement" class="card bg-white shadow-sm border-0">
				<div class="leftbar-announcement-body">
					<div class="leftbar-announcement-title text-white">公告</div>
					<div class="leftbar-announcement-content text-white">个人博客。</div>
				</div>
			</div>
		
		<div id="leftbar_part1" class="widget widget_search card bg-white shadow-sm border-0">
			<div class="leftbar-banner card-body">
				<span class="leftbar-banner-title text-white">沉石鱼惊旋 的博客</span>
				
				
					<span class="leftbar-banner-subtitle text-white"><span class='hitokoto'></span></span>
				
			</div>
			
			
				<ul id='leftbar_part1_menu' class='leftbar-menu'>
					<li class='leftbar-menu-item'><a href='/'>首页</a></li><li class='leftbar-menu-item'><a href='/archives'>归档</a></li><li class='leftbar-menu-item leftbar-menu-item-haschildren'><a no-pjax onclick='return false;'>实用工具</a><ul class='leftbar-menu-item leftbar-menu-subitem shadow-sm'><li class='leftbar-menu-item'><a target="_blank" rel="noopener" href='https://lab.magiconch.com/homo/'>恶臭数学分解器</a></li><li class='leftbar-menu-item'><a target="_blank" rel="noopener" href='https://lab.magiconch.com/nbnhhsh/'>缩写查询</a></li><li class='leftbar-menu-item'><a target="_blank" rel="noopener" href='https://www.luogu.com.cn/blog/IowaBattleship/latex-gong-shi-tai-quan'>$\LaTeX$ 公式大全</a></li><li class='leftbar-menu-item'><a target="_blank" rel="noopener" href='https://zh.numberempire.com/factoringcalculator.php'>因式分解</a></li><li class='leftbar-menu-item'><a target="_blank" rel="noopener" href='https://csacademy.com/app/graph_editor/'>图论绘画</a></li></ul></li><li class='leftbar-menu-item'><a target="_blank" rel="noopener" href='http://cyx2009.top/'>目录</a></li>
				</ul>
			
			<div class="card-body text-center leftbar-search-button">
				<button id="leftbar_search" class="btn btn-secondary btn-lg active btn-sm btn-block border-0" role="button" data-toggle="modal" data-target="#argon_search_modal" >
					<i class="menu-item-icon fa fa-search mr-0"></i> 搜索
				</button>
			</div>
		</div>
		<div id="leftbar_part2" class="widget widget_search card bg-white shadow-sm border-0">
			<div id="leftbar_part2_inner" class="card-body">
				
				<div class="nav-wrapper" style="padding-top: 5px;">
	                <ul class="nav nav-pills nav-fill" role="tablist">
						
							<li class="nav-item sidebar-tab-switcher">
								<a class="active show" id="leftbar_tab_catalog_btn" data-toggle="tab" href="#leftbar_tab_catalog" role="tab" aria-controls="leftbar_tab_catalog" no-pjax>文章目录</a>
							</li>
						
						<li class="nav-item sidebar-tab-switcher">
							<a class="" id="leftbar_tab_overview_btn" data-toggle="tab" href="#leftbar_tab_overview" role="tab" aria-controls="leftbar_tab_overview" no-pjax>站点概览</a>
						</li>
	                </ul>
				</div>
				<div>
					<div class="tab-content" style="padding: 10px 10px 0 10px;">
						
							<div class="tab-pane fade active show" id="leftbar_tab_catalog" role="tabpanel" aria-labelledby="leftbar_tab_catalog_btn">
								<div id="leftbar_catalog"></div>
								<script type="text/javascript">
									$(function () {
										$(document).headIndex({
											articleWrapSelector: '#post_content',
											indexBoxSelector: '#leftbar_catalog',
											subItemBoxClass: "index-subItem-box",
											itemClass: "index-item",
											linkClass: "index-link",
											offset: 80,
										});
									})
								</script>
								
									<style>
										#leftbar_catalog ul {
											counter-reset: blog_catalog_number;
										}
										#leftbar_catalog li.index-item > a:before {
											content: counters(blog_catalog_number, '.') " ";
											counter-increment: blog_catalog_number;
										}
									</style>
								
							</div>
						
						<div class="tab-pane fade text-center" id="leftbar_tab_overview" role="tabpanel" aria-labelledby="leftbar_tab_overview_btn">
							<img id="leftbar_overview_author_image" src="/assets/img/favicon.ico" class="img-fluid rounded-circle shadow-sm" style="width: 100px;" alt="avatar">
							<h6 id="leftbar_overview_author_name">沉石鱼惊旋</h6>
							<nav class="site-state">
								<div class="site-state-item site-state-posts">
									<a href="/archives">
										<span class="site-state-item-count">166</span>
										<span class="site-state-item-name">文章</span>
									</a>
								</div>
								<div class="site-state-item site-state-categories">
									<a data-toggle="modal" data-target="#blog_categories">
										<span class="site-state-item-count">5</span>
										<span class="site-state-item-name">分类</span>
									</a>
								</div>      
								<div class="site-state-item site-state-tags">
									<a data-toggle="modal" data-target="#blog_tags">
										<span class="site-state-item-count">4</span>
										<span class="site-state-item-name">标签</span>
									</a>
								</div>
							</nav>
							
									<div class="site-author-links">
										
											<div class='site-author-links-item'>
												<a href="https://codeforces.com/profile/Caylex" rel='noopener' target='_blank'>CF 账号</a>
											</div>
										
											<div class='site-author-links-item'>
												<a href="https://atcoder.jp/users/cayaxi09" rel='noopener' target='_blank'>AT 账号</a>
											</div>
										
											<div class='site-author-links-item'>
												<a href="https://www.luogu.com.cn/user/516346" rel='noopener' target='_blank'>洛谷账号</a>
											</div>
										
									</div>
								
							
									<div class='site-friend-links'>
										<div class='site-friend-links-title'><i class='fa fa-fw fa-link'></i> Links</div>
										<ul class='site-friend-links-ul'>
											
												<li class='site-friend-links-item'>
													<a href='http://yin-xin.fun/' rel='noopener' target='_blank'>吟心</a>
												</li>
											
										</ul>
									</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
</aside>
<div class="modal fade" id="blog_categories" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">分类</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<a class="badge badge-secondary tag" href="/categories/Essay/" rel="tag">Essay <span class="tag-num">4</span></a><a class="badge badge-secondary tag" href="/categories/Solution/" rel="tag">Solution <span class="tag-num">147</span></a><a class="badge badge-secondary tag" href="/categories/StudyNote/" rel="tag">StudyNote <span class="tag-num">4</span></a><a class="badge badge-secondary tag" href="/categories/Technology/" rel="tag">Technology <span class="tag-num">1</span></a><a class="badge badge-secondary tag" href="/categories/TravelNote/" rel="tag">TravelNote <span class="tag-num">10</span></a>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="blog_tags" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">标签</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<a class="badge badge-secondary tag" href="/tags/%E4%B9%B1%E6%90%9E/" rel="tag">乱搞 <span class="tag-num">2</span></a><a class="badge badge-secondary tag" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="tag">动态规划 <span class="tag-num">1</span></a><a class="badge badge-secondary tag" href="/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/" rel="tag">模拟赛 <span class="tag-num">20</span></a><a class="badge badge-secondary tag" href="/tags/%E9%AD%94%E6%80%94%E6%9D%AF/" rel="tag">魔怔杯 <span class="tag-num">2</span></a>
			</div>
		</div>
	</div>
</div>


<div id="primary" class="content-area">
	<main id="main" class="site-main" role="main">
		
		
			
	<article class="post post-full card bg-white shadow-sm border-0 post-preview">
	<header class="post-header text-center post-header-with-thumbnail">
		
				<img class='post-thumbnail lazyload' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABBJREFUeNpi+P//PwNAgAEACPwC/tuiTRYAAAAASUVORK5CYII=' data-original='https://cdn.luogu.com.cn/upload/image_hosting/ddbq2clq.png' alt='thumbnail'></img>
				<div class='post-header-text-container'>
			
		<a class="post-title" href="/archives/Mo_s_algorithm/">[笔记] 莫队 学习笔记</a>
		<div class="post-meta">
			
						
						<div class="post-meta-detail post-meta-detail-time">
							<i class="fa fa-clock-o" aria-hidden="true"></i>
							<time title="发布于 2024-2-2 11:10:00 | 编辑于 2025-2-12 20:27:58">2024-2-2 11:10
							</time>
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-categories">
							<i class="fa fa-bookmark-o" aria-hidden="true"></i>
							<a class="post-meta-detail-catagory-link" href="/categories/StudyNote/">StudyNote</a>
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-words">
							<i class="fa fa fa-book" aria-hidden="true"></i>
							<span id="busuanzi_container_page_pv">
								阅读<span id="busuanzi_value_page_pv"></span>次
							</span>
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-words">
							<i class="fa fa-file-word-o" aria-hidden="true"></i>
							2k 字
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-readingtime">
							<i class="fa fa-hourglass-end" aria-hidden="true"></i>
							9 分钟
						</div>
					
		</div>
		
				</div>
			
	</header>

	<div class="post-content" id="post_content">
		<p>蒸馍身边一群大神不会普通莫队。</p>
<p>现在每天半夜不写点根号算法都睡不着。根号算法个个是优雅的算法&#x2F;se</p>
<h1 id="莫队"><a href="#莫队" class="headerlink" title="莫队"></a>莫队</h1><p>处理离线区间询问。</p>
<p>名字由来是因为是莫涛整理的。</p>
<h1 id="普通莫队"><a href="#普通莫队" class="headerlink" title="普通莫队"></a>普通莫队</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>可以较优复杂度从 $[l\pm1,r\pm1]$ 转到 $[l,r]$。</p>
<p>当 $n,q$ 同阶时，若转移为 $\mathcal O(1)$，总复杂度即为 $\mathcal O(n\sqrt n)$。同理，转移为 $\mathcal O(log n)$ 复杂度即为 $\mathcal O(n\sqrt n\log n)$。</p>
<p>$n,q$ 不同阶参考 OI Wiki 的复杂度分析。</p>
<p><a target="_blank" rel="noopener" href="https://oi-wiki.org/misc/mo-algo/#%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90">https://oi-wiki.org/misc/mo-algo/#%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90</a></p>
<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><p>对于询问的排序，一般是对 $L$ 分块，先按块排序，每个块内再按 $R$ 排序。一般这样即可，但是更好的写法可以继续奇偶性优化少掉不同块内 $R$ 从 $n$ 再次回到 $1$ 的过程。</p>
<p>以下为排序代码，其中 $fa_i$ 表示 $i$ 在那一块。</p>
<pre><code class="highlight cpp"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span></span>
<span class="function"></span>&#123;
    <span class="keyword">if</span> (fa[a.L] != fa[b.L])
        <span class="keyword">return</span> a.L &lt; b.L;
    <span class="keyword">if</span> (fa[a.L] &amp; <span class="number">1</span>)
        <span class="keyword">return</span> a.R &gt; b.R;
    <span class="keyword">return</span> a.R &lt; b.R;
&#125;</code></pre>

<p>也就是说，不进行奇偶性优化的莫队，询问排序后长这样：</p>
<p><img class="lazyload lazyload-style-11" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://cdn.luogu.com.cn/upload/image_hosting/ddbq2clq.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"></p>

<p>而进行了奇偶性优化的话：</p>
<p><img class="lazyload lazyload-style-11" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://cdn.luogu.com.cn/upload/image_hosting/jo4d8k7b.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"></p>

<p>这样子就可以让 $R$ 更加连贯。</p>
<p>图中红线表示分块的界线，黑线表示区间询问范围。</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><pre><code class="highlight cpp"><span class="type">int</span> L = <span class="number">1</span>, R = <span class="number">0</span>;
<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; i++)
&#123;
    <span class="keyword">while</span> (L &gt; Query[i].L)
        <span class="built_in">add</span>(--L);
    <span class="keyword">while</span> (R &lt; Query[i].R)
        <span class="built_in">add</span>(++R);
    <span class="keyword">while</span> (L &lt; Query[i].L)
        <span class="built_in">del</span>(L++);
    <span class="keyword">while</span> (R &gt; Query[i].R)
        <span class="built_in">del</span>(R--);
    ans[Query[i].id] = ANS;
&#125;</code></pre>

<p>其中 $add(x)$ 和 $del(x)$ 分别表示添加第 $x$ 个位置和删除第 $x$ 个位置进行的操作。</p>
<p>当然，有的题 $L$ 和 $R$ 的添加删除是不一样的。</p>
<p>这是个循环位置的顺序，参考 <a target="_blank" rel="noopener" href="https://oi-wiki.org/misc/mo-algo/#%E8%BF%87%E7%A8%8B">https://oi-wiki.org/misc/mo-algo/#%E8%BF%87%E7%A8%8B</a> 关于四个循环位置的讨论。一般来说你只要保证先扩张后缩减是不会有问题的。</p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="P1972-SDOI2009-HH的项链"><a href="#P1972-SDOI2009-HH的项链" class="headerlink" title="P1972 [SDOI2009] HH的项链"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1972">P1972 [SDOI2009] HH的项链</a></h3><p>我们将此题作为莫队模板进行讲解。</p>
<p>可是这题莫队标签都没有！那是因为大家不会卡常。</p>
<p>记录颜色数，即为记录 $h_i$ 表示 $i$ 在序列中出现的次数，新出现加一种颜色，被删完少一种颜色。</p>
<p>那么我们很快就能码好：</p>
<pre><code class="highlight cpp"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span>
<span class="keyword">using</span> <span class="keyword">namespace</span> std;
<span class="type">int</span> fa[<span class="number">1000020</span>];
<span class="type">int</span> a[<span class="number">1000020</span>];
<span class="type">int</span> ans[<span class="number">1000020</span>];
<span class="type">int</span> h[<span class="number">1000020</span>];
<span class="type">int</span> n, len, ANS, q;
<span class="meta">#<span class="keyword">define</span> getchar() p1 == p2 &amp;&amp; (p2 = (p1 = buf) + fread(buf, 1, 1000000, stdin), p1 == p2) ? EOF : *p1++</span>
<span class="type">char</span> buf[<span class="number">1000000</span>], *p1 = buf, *p2 = buf;
<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>
<span class="function"></span>&#123;
    <span class="keyword">register</span> <span class="type">char</span> c = <span class="built_in">getchar</span>();
    <span class="keyword">register</span> <span class="type">int</span> x = <span class="number">0</span>;
    <span class="keyword">while</span> (c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>)
        c = <span class="built_in">getchar</span>();
    <span class="keyword">while</span> (c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>)
        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();
    <span class="keyword">return</span> x;
&#125;
<span class="keyword">struct</span> <span class="title class_">node</span>
&#123;
    <span class="type">int</span> L, R, id;
&#125; Query[<span class="number">1000020</span>];
<span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span></span>
<span class="function"></span>&#123;
    <span class="keyword">if</span> (fa[a.L] != fa[b.L])
        <span class="keyword">return</span> a.L &lt; b.L;
    <span class="keyword">if</span> (fa[a.L] &amp; <span class="number">1</span>)
        <span class="keyword">return</span> a.R &gt; b.R;
    <span class="keyword">return</span> a.R &lt; b.R;
&#125;
<span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>
<span class="function"></span>&#123;
    n = <span class="built_in">read</span>();
    len = <span class="built_in">sqrt</span>(n);
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)
    &#123;
        a[i] = <span class="built_in">read</span>();
        fa[i] = (i + len - <span class="number">1</span>) / len;
    &#125;
    q = <span class="built_in">read</span>();
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; i++)
    &#123;
        <span class="type">int</span> L, R;
        L = <span class="built_in">read</span>();
        R = <span class="built_in">read</span>();
        Query[i] = &#123;L, R, i&#125;;
    &#125;
    <span class="built_in">sort</span>(Query + <span class="number">1</span>, Query + q + <span class="number">1</span>, cmp);
    <span class="type">int</span> L = <span class="number">1</span>, R = <span class="number">0</span>;
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; i++)
    &#123;
        <span class="keyword">while</span> (L &gt; Query[i].L)
            ANS += (++h[a[--L]] == <span class="number">1</span>);
        <span class="keyword">while</span> (R &lt; Query[i].R)
            ANS += (++h[a[++R]] == <span class="number">1</span>);
        <span class="keyword">while</span> (L &lt; Query[i].L)
            ANS -= (--h[a[L++]] == <span class="number">0</span>);
        <span class="keyword">while</span> (R &gt; Query[i].R)
            ANS -= (--h[a[R--]] == <span class="number">0</span>);
        ans[Query[i].id] = ANS;
    &#125;
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; i++)
    &#123;
        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);
    &#125;
    <span class="keyword">return</span> <span class="number">0</span>;
&#125;</code></pre>

<p>诶，T 了！本题莫队真的过不去吗？</p>
<p>我的评价是我这题不关同步的 cin 都过了。</p>
<pre><code class="highlight cpp"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span>
<span class="keyword">using</span> <span class="keyword">namespace</span> std;
<span class="type">int</span> fa[<span class="number">1000020</span>];
<span class="type">int</span> a[<span class="number">1000020</span>];
<span class="type">int</span> ans[<span class="number">1000020</span>];
<span class="type">int</span> pre[<span class="number">1000020</span>];
<span class="type">int</span> nxt[<span class="number">1000020</span>];
<span class="type">int</span> p[<span class="number">1000020</span>];
<span class="type">int</span> n, len, ANS, q;
<span class="meta">#<span class="keyword">define</span> getchar() p1 == p2 &amp;&amp; (p2 = (p1 = buf) + fread(buf, 1, 1000000, stdin), p1 == p2) ? EOF : *p1++</span>
<span class="type">char</span> buf[<span class="number">1000000</span>], *p1 = buf, *p2 = buf;
<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>
<span class="function"></span>&#123;
    <span class="keyword">register</span> <span class="type">char</span> c = <span class="built_in">getchar</span>();
    <span class="keyword">register</span> <span class="type">int</span> x = <span class="number">0</span>;
    <span class="keyword">while</span> (c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>)
        c = <span class="built_in">getchar</span>();
    <span class="keyword">while</span> (c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>)
        x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();
    <span class="keyword">return</span> x;
&#125;
<span class="keyword">struct</span> <span class="title class_">node</span>
&#123;
    <span class="type">int</span> L, R, id;
&#125; Query[<span class="number">1000020</span>];
<span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span></span>
<span class="function"></span>&#123;
    <span class="keyword">if</span> (fa[a.L] != fa[b.L])
        <span class="keyword">return</span> a.L &lt; b.L;
    <span class="keyword">if</span> (fa[a.L] &amp; <span class="number">1</span>)
        <span class="keyword">return</span> a.R &gt; b.R;
    <span class="keyword">return</span> a.R &lt; b.R;
&#125;
<span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>
<span class="function"></span>&#123;
    n = <span class="built_in">read</span>();
    len = <span class="built_in">sqrt</span>(n);
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)
    &#123;
        a[i] = <span class="built_in">read</span>();
        fa[i] = (i + len - <span class="number">1</span>) / len;
        nxt[i] = n + <span class="number">1</span>;
        pre[i] = p[a[i]];
        nxt[pre[i]] = i;
        p[a[i]] = i;
    &#125;
    q = <span class="built_in">read</span>();
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; i++)
    &#123;
        <span class="type">int</span> L, R;
        L = <span class="built_in">read</span>();
        R = <span class="built_in">read</span>();
        Query[i] = &#123;L, R, i&#125;;
    &#125;
    <span class="built_in">sort</span>(Query + <span class="number">1</span>, Query + q + <span class="number">1</span>, cmp);
    <span class="type">int</span> L = <span class="number">1</span>, R = <span class="number">0</span>;
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; i++)
    &#123;
        <span class="keyword">while</span> (L &gt; Query[i].L)
            ANS += (nxt[--L] &gt; R);
        <span class="keyword">while</span> (R &lt; Query[i].R)
            ANS += (pre[++R] &lt; L);
        <span class="keyword">while</span> (L &lt; Query[i].L)
            ANS -= (nxt[L++] &gt; R);
        <span class="keyword">while</span> (R &gt; Query[i].R)
            ANS -= (pre[R--] &lt; L);
        ans[Query[i].id] = ANS;
    &#125;
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; i++)
    &#123;
        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);
    &#125;
    <span class="keyword">return</span> <span class="number">0</span>;
&#125;</code></pre>

<p>为什么这样可过呢，我们发现，观察一个数在序列中是否是只出现一次，只需要看同一颜色的数，是否已经出现过了。有点废话文学，但是『只需要看同一颜色的数，是否已经出现过了』就是记录这个数上一次出现的位置和下一次出现的位置。</p>
<p>所以，我们考虑记录 $pre_i$ 和 $nxt_i$ 表示 $a_i$ 上一次或下一次出现的位置用来辅助区间转移。</p>
<p>这样子就可以做到莫队过程访址连续，真正的 $\mathcal O(n\sqrt n)$。</p>
<h3 id="P1494-国家集训队-小-Z-的袜子"><a href="#P1494-国家集训队-小-Z-的袜子" class="headerlink" title="P1494 [国家集训队] 小 Z 的袜子"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1494">P1494 [国家集训队] 小 Z 的袜子</a></h3><p>记录每个区间此时颜色数量，那么颜色数量 $-1$ 即为此时这个颜色能配成多少对。答案分母显然是 $\dbinom{R-L+1}{2}$。分子即为所有颜色能配成多少对。</p>
<h3 id="P2709-小-B-的询问"><a href="#P2709-小-B-的询问" class="headerlink" title="P2709 小 B 的询问"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2709">P2709 小 B 的询问</a></h3><p>也是区间数颜色。每种颜色个数平方一下即可。</p>
<h3 id="P3901-数列找不同"><a href="#P3901-数列找不同" class="headerlink" title="P3901 数列找不同"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3901">P3901 数列找不同</a></h3><p>判断区间颜色数是否 $&#x3D;R-L+1$。</p>
<h3 id="CF351D-Jeff-and-Removing-Periods"><a href="#CF351D-Jeff-and-Removing-Periods" class="headerlink" title="CF351D Jeff and Removing Periods"></a><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/351/D">CF351D Jeff and Removing Periods</a></h3><p>为了方便描述，我们约定数值相同的数为同一颜色的数。</p>
<p>有 $n$ 个数，我们定义一次操作为：选择若干个同颜色数，使得他们在序列中的位置为一个等差数列。删除它们。</p>
<p>操作完之后可以重排整个序列。</p>
<p>有 $q$ 个询问，每次询问给定 $[l,r]$，求至少几次操作能全部删除 $[l,r]$。</p>
<p>询问互不影响。</p>
<p>$1\leq n,q,a_i\leq 10^5$</p>
<p><a href="http://blog.cyx2009.top/archives/250/">http://blog.cyx2009.top/archives/250/</a> 查看。</p>
<p>或洛谷题解区最高赞题解。</p>
<p><img class="lazyload lazyload-style-11" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://cdn.luogu.com.cn/upload/image_hosting/2i6hvf8d.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"></p>

<h3 id="ABC293G-Triple-Index"><a href="#ABC293G-Triple-Index" class="headerlink" title="ABC293G Triple Index"></a><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc293/tasks/abc293_g">ABC293G Triple Index</a></h3><p>给定长度为 $N$ 的数列 $a_1,a_2,\cdots,a_N$。</p>
<p>$q$ 组询问，每组询问给定 $l,r$ 且 $1\le l\le r \le n$，问存在多少个三元组 $(i,j,k)$，使得 $l\le i &lt; j&lt;k\le r$ 且 $a_i&#x3D;a_j&#x3D;a_k$。</p>
<p>考虑增加颜色和删除颜色贡献，设当前位置的颜色是 $x$，共显示 $\pm \dfrac{(h_x-1)(h_x-2)}{2}$。其中 $h_i$ 表示颜色 $i$ 的个数。</p>
<h3 id="TENKA1-2014-FINAL-D"><a href="#TENKA1-2014-FINAL-D" class="headerlink" title="TENKA1_2014_FINAL D"></a><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/tenka1-2014-final/tasks/tenka1_2014_final_d">TENKA1_2014_FINAL D</a></h3><p>$m$ 组询问，每次给定 $n,k$，求 $\sum\limits_{i&#x3D;0}^k \binom{n}{i}$。</p>
<p>$1 \le n, m, k \le 10^5$。</p>
<p>很好数学，爱来自莫队。</p>
<p>$\dbinom{n}{k-1}\to\dbinom{n}{k},ans\gets ans+\dbinom{n}{k}$</p>
<p>$\dbinom{n}{k+1}\to\dbinom{n}{k},ans\gets ans-\dbinom{n}{k+1}$</p>
<p>$\dbinom{n-1}{k}\to\dbinom{n}{k},ans\gets 2ans-\dbinom{n-1}{k}$</p>
<p>$\dbinom{n+1}{k}\to\dbinom{n}{k},ans\gets \dfrac{ans+\dbinom{n}{k}}{2}$</p>
<p>改变 $k$ 是显然的，改变 $n$ 用帕斯卡法则拆一下即可得到 $\dbinom{n-1}{k}\to\dbinom{n}{k}$ 的答案变化，另一个同理。</p>
<h3 id="SP-DQUERY-D-query"><a href="#SP-DQUERY-D-query" class="headerlink" title="SP DQUERY - D-query"></a><a target="_blank" rel="noopener" href="https://www.spoj.com/problems/DQUERY/">SP DQUERY - D-query</a></h3><p>给出一个长度为 $n$ 的数列，$a_1,a_2,\dots,a_n$ ，有 $q$ 个询问，每个询问给出数对$(i,j)$，需要你给出 $a_{i},a_{i+1},\dots ,a_{j}$ 这一段中有多少不同的数字。</p>
<p>也是区间数颜色。</p>

	</div>

	
		<div class="post-donate">
			<button class="btn donate-btn btn-danger">赞赏</button>
			<div class="donate-qrcode card shadow-sm bg-white">
				<img src="http://img.cyx2009.top/pay_wx.jpg">
			</div>
		</div>
	

	
			<div class='additional-content-after-post'>爱你宝宝！</div>
		

	
</article>

	<div id="share_container">
	<div id="share" data-initialized="true">
		<a class="no-pjax icon-wechat" tooltip="分享到微信">
			<button class="btn btn-icon btn-success">
				<span class="btn-inner--icon"><i class="fa fa-weixin"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-douban" tooltip="分享到豆瓣">
			<button class="btn btn-icon btn-primary" style="background: #209261;border: none;">
				豆
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-qq" tooltip="分享到 QQ">
			<button class="btn btn-icon btn-primary" style="background: #2196f3;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-qq"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-qzone" tooltip="分享到 QQ 空间">
			<button class="btn btn-icon btn-primary" style="background: #ffc107;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-star"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-weibo" tooltip="分享到微博">
			<button class="btn btn-icon btn-warning">
				<span class="btn-inner--icon"><i class="fa fa-weibo"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-facebook" tooltip="分享到 Facebook">
			<button class="btn btn-icon btn-primary" style="background: #283593;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-facebook"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-twitter" tooltip="分享到 Twitter">
			<button class="btn btn-icon btn-primary" style="background: #03a9f4;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-twitter"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-telegram" href="https://telegram.me/share/url?url=http://blog.cyx2009.top/archives/Mo_s_algorithm/&text=[笔记] 莫队 学习笔记" tooltip="分享到 Telegram">
			<button class="btn btn-icon btn-primary" style="background: #42a5f5;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-telegram"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-copy-link" id="share_copy_link" tooltip="复制链接">
			<button class="btn btn-icon btn-default">
				<span class="btn-inner--icon"><i class="fa fa-link"></i></span>
			</button>
		</a>
	</div>
	<button id="share_show" class="btn btn-icon btn-primary" tooltip="分享">
		<span class="btn-inner--icon"><i class="fa fa-share"></i></span>
	</button>
</div>
<script type="text/javascript">
	socialShare("#share", {
	    title : '[笔记] 莫队 学习笔记',
	    description : '蒸馍身边一群大神不会普通莫队。
现在每天半夜不写点根号算法都睡不着。根号算法个个是优雅的算法&amp;#x2...',
	    wechatQrcodeTitle : "分享到微信",
	    wechatQrcodeHelper : '微信扫描二维码',
	    source : 'http://blog.cyx2009.top/archives/Mo_s_algorithm/'
	});
	$("#share_show")[0].onclick = function(){
		$("#share_container").addClass("opened");
	};
	$("#share_copy_link")[0].onclick = function(){
		let input = document.createElement('input');
		document.body.appendChild(input);
		input.setAttribute("value", window.location.href);
		input.setAttribute("readonly", "readonly");
		input.setAttribute("style", "opacity: 0;mouse-events:none;");
		input.select();
		if (document.execCommand('copy')){
			iziToast.show({
				title: '链接已复制',
				message: "链接已复制到剪贴板",
				class: 'shadow',
				position: 'topRight',
				backgroundColor: '#2dce89',
				titleColor: '#ffffff',
				messageColor: '#ffffff',
				iconColor: '#ffffff',
				progressBarColor: '#ffffff',
				icon: 'fa fa-check',
				timeout: 5000
			});
		}else{
			iziToast.show({
				title: '复制失败',
				message: "请手动复制链接",
				class: 'shadow',
				position: 'topRight',
				backgroundColor: '#f5365c',
				titleColor: '#ffffff',
				messageColor: '#ffffff',
				iconColor: '#ffffff',
				progressBarColor: '#ffffff',
				icon: 'fa fa-close',
				timeout: 5000
			});
		}
		document.body.removeChild(input);
	};
</script>



	<div id="post_comment" class="card shadow-sm">
		<div id="giscus"></div>
<script src="https://giscus.app/client.js"
        data-repo="chenyuxuan2009/blogtalk"
        data-repo-id="R_kgDOHDKqeg"
        data-category="General"
        data-category-id="DIC_kwDOHDKqes4COOnc"
        data-mapping="pathname"
        data-input-position="top"
        data-theme="light"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

	</div>



<div class="post-navigation card shadow-sm"><div class="post-navigation-item post-navigation-pre"><span class="page-navigation-extra-text"><i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i>上一篇</span><a href="/archives/ABC339F/" rel="prev"> [题解] ABC339F Product Equality</a></div><div class="post-navigation-item post-navigation-next"><span class="page-navigation-extra-text">下一篇 <i class="fa fa-arrow-circle-o-right" aria-hidden="true"></i></span><a href="/archives/CF351D/" rel="next"> [题解] CF351D Jeff and Removing Periods</a></div></div>



<!-- <script type="text/javascript" src="/assets/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/assets/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<script type="text/javascript" src="/assets/codeBlock/codeCopy.js"></script>
<script type="text/javascript" src="/assets/codeBlock/clipboard.min.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/assets/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 --> -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>

		
		
		
		

					<footer id="footer" class="site-footer card shadow-sm border-0">
						
						<div>Theme <a target="_blank" rel="noopener" href="https://github.com/solstice23/hexo-theme-argon"><strong>Argon</strong></a> | Powered by Hexo</div>
						<span id="busuanzi_container_site_uv">
							本站访客数 <span id="busuanzi_value_site_uv"></span> 人次
						</span>
						<span id="timeDate">载入时间...</span>
						<script>
						    var now = new Date(); 
						    function createtime() { 
						        var grt= new Date("03/28/2022 20:00:00");//在此处修改你的建站时间
						        now.setTime(now.getTime()+250); 
						        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
						        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
						        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
						        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
						        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
						        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
						        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "+ hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
						        // document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
						    } 
						setInterval("createtime()",250);
						</script>
						<script>
        window.onload = (() => {
            //定义点击出现文字类
            function ClickFrontShow() {
                //定义所需文字和颜色
                this.fron = ['复杂度', '枚举', '模拟', '递归 & 分治', '贪心', '排序',
                    '前缀和 & 差分', '二分', '倍增', '构造',
                    'DFS（搜索）', 'BFS（搜索）', '双向搜索', '启发式搜索', 'A*',
                    '迭代加深搜索', 'IDA*', '回溯法', 'Dancing Links',
                    'Alpha-Beta 剪枝',
                    '记忆化搜索', '背包 DP', '区间 DP', 'DAG 上的 DP', '树形 DP',
                    '状压 DP', '数位 DP', '插头 DP', '计数 DP', '动态 DP',
                    '概率 DP',
                    '字符串匹配', '字符串哈希', '字典树 (Trie)', '前缀函数与 KMP 算法',
                    'Boyer-Moore 算法', 'Z 函数（扩展 KMP）', '自动机',
                    'AC 自动机', '后缀数组 (SA)', '后缀自动机 (SAM)', '后缀平衡树',
                    '广义后缀自动机', '后缀树', 'Manacher', '回文树', '序列自动机',
                    '最小表示法', 'Lyndon 分解', 'Main-Lorentz 算法',
                    '符号', '进位制', '位运算', '二进制集合操作', '平衡三进制', '高精度计算',
                    '快速幂', '置换和排列', '弧度制与坐标系', '复数', '数论',
                    '多项式与生成函数', '组合数学', '线性代数', '线性规划', '群论', '概率论',
                    '博弈论', '牛顿迭代法', '数值积分', '傅里叶-莫茨金消元法', '序理论',
                    '杨氏矩阵', 'Schreier–Sims 算法',
                    'Berlekamp-Massey 算法',
                    '栈', '队列', '链表', '哈希表', '并查集', '堆', '块状数据结构',
                    '单调栈', '单调队列', 'ST 表', '树状数组', '线段树', '李超线段树',
                    '区间最值操作 & 区间历史最值', '划分树', '二叉搜索树 & 平衡树', '跳表',
                    '可持久化数据结构', '树套树', 'K-D Tree', '动态树', '析合树',
                    'PQ 树', '手指树', '霍夫曼树',
                    '图论相关概念', '图的存储', 'DFS（图论）', 'BFS（图论）', '树上问题',
                    '矩阵树定理', '有向无环图', '拓扑排序', '最小生成树', '斯坦纳树',
                    '最小树形图', '最小直径生成树', '最短路', '拆点', '差分约束', 'k 短路',
                    '同余最短路', '连通性相关', '2-SAT', '欧拉图', '哈密顿图', '二分图',
                    '最小环', '平面图', '图的着色', '网络流', 'Stoer-Wagner 算法',
                    '图的匹配', 'Prufer 序列', 'LGV 引理', '弦图', '最大团搜索算法',
                    '二维计算几何基础', '三维计算几何基础', '距离', 'Pick 定理', '三角剖分',
                    '凸包', '扫描线', '旋转卡壳', '半平面交', '平面最近点对', '随机增量法',
                    '反演变换', '计算几何杂项',
                    '离散化', '双指针', '离线算法', '分数规划', '随机化', '悬线法',
                    '计算理论基础', '字节顺序', '约瑟夫问题', '格雷码', '表达式求值',
                    '在一台机器上规划任务', '主元素问题', 'Garsia-Wachs 算法',
                    '15-puzzle', 'Kahan 求和', '珂朵莉树/颜色段均摊',
                    'RMQ', '并查集应用', '括号序列', '线段树与离线询问'
                ];
                this.colo = ['#FF69B4', '#ff6651', 'orange', '#FF00FF',
                    '#00FF7F', '#00BFFF', '#BA55D3'
                ];
                //获取body元素
                this.elBody = document.getElementsByTagName("body")[0];
                //初始化randomNum
                this.randomNum = null;
                //初始化字体inde
                this.finde = 0;
                //初始化className
                this.cls = 0;
            }

            //定义初始化
            ClickFrontShow.prototype.init = function(frontArray,
                colorArray) {
                //自定义颜色和字体
                this.fron = frontArray || this.fron;
                this.colo = colorArray || this.colo;

                this.listenMouse();
            }

            //创建文字
            ClickFrontShow.prototype.createFront = function(classname) {
                var self = this;
                let ospan = document.createElement('span');
                //设置样式
                let cssText =
                    // "width: 100%; height: 100%; top: 0; left: 0; z-index: 99999; position: fixed;";
                    // "position:absolute; cursor: default; transform: translate(-50%,-50%); font-weight: bold; opacity: 1; z-index: 1000; transition: 1s;width: 100%; height: 100%;pointer-events: none;";
                    // "position:absolute; width: 40px; height: 20px; cursor: default; transform: translate(-50%,-50%); font-weight: bold; opacity: 1; z-index: 1000; transition: 1s;";
                    "position:fixed; width: 40px; height: 20px; cursor: default; transform: translate(-50%,-50%); font-weight: bold; opacity: 1; z-index: 1000; transition: 1s;";
                //随机字体和颜色
                let randomFront = self.fron[Math.round(Math
                    .random() * (self.fron.length - 1))];
                let randomColor = self.colo[Math.round(Math
                    .random() * (self.colo.length - 1))];
                //字体下标增1
                self.finde = (self.finde + 1) % self.fron.length;
                //向body中添加元素
                self.elBody.appendChild(ospan);
                //绑定一个classname
                ospan.className = String(classname);
                //添加样式
                ospan.style.cssText = cssText +
                    "-moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;user-select: none;"
                ospan.style.color = randomColor;
                ospan.innerHTML = randomFront;
            }


            //监听鼠标点击
            ClickFrontShow.prototype.listenMouse = function() {
                var self = this;

                //鼠标点击事件
                document.onclick = function(e) {
                    //避免classname值重复导致出现bug
                    if (self.cls === 20) {
                        self.cls = 0;
                    } else {
                        self.cls += 1;
                    }
                    //创建文字
                    self.createFront(self.cls);
                    let el = document.getElementsByClassName(
                        self.cls)[0];

                    //鼠标点击位置

                    el.style.left = e.clientX + 'px';
                    el.style.top = e.clientY + 'px';
                    // alert('x: '+el.style.left+' y: '+el.style.top);

                    //过时改变
                    setTimeout(function() {
                        el.style.opacity = 0;
                        el.style.top = el.offsetTop -
                            100 + 'px';
                    }, 100);
                    //过时清除
                    setTimeout(function() {
                        self.elBody.removeChild(el);
                    }, 2000);
                }
            }
            //实例化
            var frontShow = new ClickFrontShow();
            //用户可在此传递参数，默认第一个参数是字体数组；
            //第二个参数是颜色数组，必须是数组类型！
            frontShow.init();
        })();
						</script>
					</footer>
				</main>
			</div>
		</div>
		
<script src="/argontheme.js"></script>

		
		
		
			<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.6/katex.min.css">
			<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.6/katex.min.js"></script>
			<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.6/contrib/auto-render.min.js"></script>
			<script>
				document.addEventListener("DOMContentLoaded", function() {
					renderMathInElement(document.body,{
						delimiters: [
							{left: "$$", right: "$$", display: true},
							{left: "$", right: "$", display: false},
							{left: "\\(", right: "\\)", display: false}
						]
					});
				});
			</script>
		

		
			<script>
				var argonEnableCodeHighlight = true;
			</script>
			
<link rel="stylesheet" href="/assets/vendor/highlight/styles/vs2015.css">

		

	</div>
</div>
<noscript>
	<style>
		article img.lazyload[src^="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPg"]{display: none;}
		.comment-item-text .comment-sticker.lazyload{display: none;}
	</style>
</noscript>
</body>



</html>

